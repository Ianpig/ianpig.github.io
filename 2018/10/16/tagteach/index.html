<!DOCTYPE html><html lang="zh-TW"><head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><link rel="alternate" href="https://iandays.com/2018/10/16/tagteach/" hreflang="zh-tw"><link rel="alternate" href="https://en.iandays.com/2018/10/16/tagteach/" hreflang="en"><link rel="canonical" href="https://iandays.com/2018/10/16/tagteach/"><title>Google Tag Manager(gtm)教學 觸發、代碼、變數設定介紹 | Ian Chu</title><script type="application/ld+json">[{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Google Tag Manager(gtm)教學 觸發、代碼、變數設定介紹",
  "description": "完整介紹tag manager功能設定細節、功能，建立流程步驟教學，以留言板追蹤為範例。假設我們要追蹤送出留言，建立一個事件，拿進ga當作轉換目標。",
  "mainEntityOfPage":{
      "@type":"WebPage",
      "@id": "https://iandays.com/2018/10/16/tagteach/" 
  },
  "datePublished":  "2018-10-15T16:03:46.000Z" ,
  "dateModified":  "2019-06-08T04:44:38.189Z" ,
  "image": "https://iandays.com/images/tagtool.png",
  "author": {
      "@type": "Person",
      "name":  "Ian Chu"
  },
  "publisher": {
      "@type": "Organization",
      "name":  "Ian Chu",
      "logo": {
        "@type": "ImageObject",
        "url":  "https://iandays.com/amp-dist/sample/logo.png",
        "width":  600 ,
        "height":  60 
      }
  }
},
{
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "name": "marketing",
    "item": "https://iandays.com/categories/marketing/"
  },{
    "@type": "ListItem",
    "position": 2,
    "name": "Google Tag Manager(gtm)教學 觸發、代碼、變數設定介紹",
    "item": "https://iandays.com/2018/10/16/tagteach/"
  }]
}]</script><noscript><style>img.lazyload { display: none !important; }</style></noscript><meta property="og:title" content="Google Tag Manager(gtm)教學 觸發、代碼、變數設定介紹 | Ian Chu"><meta name="description" content="完整介紹tag manager功能設定細節、功能，建立流程步驟教學，以留言板追蹤為範例。假設我們要追蹤送出留言，建立一個事件，拿進ga當作轉換目標。"><meta property="og:description" content="完整介紹tag manager功能設定細節、功能，建立流程步驟教學，以留言板追蹤為範例。假設我們要追蹤送出留言，建立一個事件，拿進ga當作轉換目標。"><meta property="og:url" content="https://iandays.com/2018/10/16/tagteach/"><meta property="og:type" content="article"><meta property="og:site_name" content="Ian Chu"><meta content="https://www.facebook.com/chu1228/" property="article:author"><meta property="og:image" content="https://iandays.com/images/logo.png"><meta name="google-site-verification" content="HAL8spli6FtFuOqxBit5nRU1vXuqhUXrRm9tyS2IEfw"><link rel="stylesheet" type="text/css" href="/css/style.css?1594052923277"><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/pure/1.0.0/grids-responsive-min.css"><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-WGLRPVD'); </script><script>var host = "iandays.com";
if ((host == window.location.host) && (window.location.protocol != "https:")){
  window.location.protocol = "https";
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><a id="logo" href="/.">Ian Chu</a><p class="description"></p><div class="switch-theme"><input id="toggle_checkbox" type="checkbox" value="on"><label for="toggle_checkbox"><div id="star"><div class="star" id="star-1">★</div><div class="star" id="star-2">★</div></div><div id="moon"></div></label></div></div><script>chooseTheme(true);
function chooseTheme(needSwitch){
    var toggle_checkbox = document.getElementById('toggle_checkbox');
    var browserDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    var value = localStorage.getItem('theme');
    if(value === 'night' || ( !value && browserDarkMode )){
        document.body.classList.add("dark");
        if(needSwitch){
            toggle_checkbox.checked = true
        }
    } else {
        document.body.classList.remove("dark"); 
    }
}</script><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首頁</i></a><a href="/archives/"><i class="fa fa-archive"> 所有文章</i></a><a href="/about/"><i class="fa fa-user"> 關於</i></a><a href="/atom.xml"><i class="fa fa-rss"> 訂閱</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Google Tag Manager(gtm)教學 觸發、代碼、變數設定介紹</h1><div class="post-meta">Jun 8, 2019<span> | </span><ol class="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList"><li class="category" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a href="/categories/marketing/" itemtype="http://schema.org/Thing" itemprop="item"><span itemprop="name">marketing</span></a><meta itemprop="position" content="1"></li><li class="article" itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem"><a href="/2018/10/16/tagteach/" itemtype="http://schema.org/Thing" itemprop="item"><span itemprop="name">Google Tag Manager(gtm)教學 觸發、代碼、變數設定介紹</span></a><meta itemprop="position" content="2"></li></ol><div class="update-date">Update: 2 years ago</div></div><a class="disqus-comment-count" data-disqus-identifier="2018/10/16/tagteach/" href="/2018/10/16/tagteach/#disqus_thread"></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目錄</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Tag-manager-設定邏輯"><span class="toc-text">Tag manager 設定邏輯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#查看html標籤"><span class="toc-text">查看html標籤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#按鈕-HTML"><span class="toc-text">按鈕 HTML</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#I-觸發條件"><span class="toc-text">I.觸發條件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tag-manager觸發簡易介紹"><span class="toc-text">tag manager觸發簡易介紹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#網頁瀏覽"><span class="toc-text">網頁瀏覽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#點擊"><span class="toc-text">點擊</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用者主動參與"><span class="toc-text">使用者主動參與</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#其他"><span class="toc-text">其他</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#II-變數"><span class="toc-text">II.變數</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#III-代碼"><span class="toc-text">III.代碼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#追蹤-adblock-實作範例"><span class="toc-text">追蹤 adblock 實作範例</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#工作實作心得"><span class="toc-text">工作實作心得</span></a></li></ol></div></div><div class="post-content"><p>之前有介紹過如何在 tag manager安裝 ga追蹤碼，埋設 tag manager的追蹤碼到網頁後，再來開始進入 tag manager設定，首先點選 <em>觸發</em> 建立好觸發邏輯，再進入 <em>代碼</em> 增加ga追蹤碼，綁定設定好的觸發點，再點選提交上去，就完成設定了。</p>
<p>雖然上次有順手寫掉事件設定，但沒有特別介紹每個設定的邏輯，這次會帶更多細節。以 <a href="https://iandays.com/work/commentboard/" title="留言板">留言板</a> 為範例。</p>
<p>假設我們要追蹤送出留言，建立一個事件，拿進ga當作轉換目標。</p>
<p>文章連結：<a href="https://iandays.com/2018/08/26/tagmanager/index.html" title="tag manager 安裝追蹤碼">tag manager 安裝追蹤碼</a> </p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagtool.png" alt="google tagmanager" title="google tagmanager"><noscript><img src="/images/tagtool.png" alt="google tagmanager" /></noscript></p>
<h2 id="Tag-manager-設定邏輯"><a href="#Tag-manager-設定邏輯" class="headerlink" title="Tag manager 設定邏輯"></a>Tag manager 設定邏輯</h2><figure class="highlight isbl"><table><tr><td class="code"><pre><span class="line">設定 <span class="function"><span class="title">trigger</span>(觸發) =&gt; 設定 <span class="title">tag</span>(代碼) =&gt; <span class="title">publish</span>(提交)</span></span><br><span class="line"></span><br><span class="line"><span class="variable">ps</span>. 每個步驟中都可以使用變數</span><br></pre></td></tr></table></figure>

<h3 id="查看html標籤"><a href="#查看html標籤" class="headerlink" title="查看html標籤"></a>查看html標籤</h3><p>所有的設定都會走上面的流程，每個代碼都一定要包含觸發。這邊我們先做一個觸發，時機點是在送出留言的時候。</p>
<p>我們先打開連結 =&gt; <a href="https://iandays.com/work/commentboard/" title="留言板">留言板</a>，打開chrome devtool( 滑鼠右鍵 -&gt; 檢查 )，點選上面的 Elements，點擊左上角的游標標誌。</p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagchromedev.png" alt="chrome devtool" title="chrome devtool"><noscript><img src="/images/tagchromedev.png" alt="chrome devtool" /></noscript></p>
<p>再把游標移到網頁上，會發現出現選取整個區塊，這時候移動到送出按鈕，用游標點擊一下，會發現右邊的html會變成選取樣式。</p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagchromedev2.png" alt="chrome devtool2" title="chrome devtool2"><noscript><img src="/images/tagchromedev2.png" alt="chrome devtool2" /></noscript></p>
<h4 id="按鈕-HTML"><a href="#按鈕-HTML" class="headerlink" title="按鈕 HTML"></a>按鈕 HTML</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;button <span class="attribute">type</span>=<span class="string">"button"</span> <span class="attribute">id</span>=<span class="string">"submitComment"</span> <span class="attribute">class</span>=<span class="string">"btn btn-secondary"</span>&gt;送出&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<p>這時候會發現按鈕的id <code>submitComment</code>，通常來說一個頁面的id只會存在一個，所以我們會用這個id被點擊來作為觸發點，如果你要用className也是沒問題，只要處理好判斷即可。</p>
<p>學會查看網頁的html很重要，學會這個工具的話，對你在設定追蹤數據有很大幫助。</p>
<h2 id="I-觸發條件"><a href="#I-觸發條件" class="headerlink" title="I.觸發條件"></a>I.觸發條件</h2><p>先來開始tag manager第一個步驟，設定觸發條件。</p>
<p>打開tag manager網頁 <a href="https://tagmanager.google.com" target="_blank" rel="noopener" title="tagmanager">tagmanager</a>，點擊觸發條件 =&gt; 新增。</p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagtri.png" alt="tag manager trigger" title="tag manager trigger"><noscript><img src="/images/tagtri.png" alt="tag manager trigger" /></noscript></p>
<p>這時候點擊觸發條件設定，右邊會展開一大堆選項，大概分類為 網頁瀏覽、點擊、使用者主動參與、其他，這四種。</p>
<p>我們選擇點擊元素，依狀況不同設定進階條件。選擇要執行的網頁路徑、click id填上 submitComment。</p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagsmaple4.png" alt="tag manager tagsmaple4" title="tag manager tagsmaple4"><noscript><img src="/images/tagsmaple4.png" alt="tag manager tagsmaple4" /></noscript></p>
<h3 id="tag-manager觸發簡易介紹"><a href="#tag-manager觸發簡易介紹" class="headerlink" title="tag manager觸發簡易介紹"></a>tag manager觸發簡易介紹</h3><p><a href="https://support.google.com/tagmanager/topic/7679384?hl=zh-Hant&ref_topic=3441647" target="_blank" rel="noopener" title="tag manager 官方觸發條件介紹">tag manager 官方觸發條件介紹</a></p>
<h3 id="網頁瀏覽"><a href="#網頁瀏覽" class="headerlink" title="網頁瀏覽"></a>網頁瀏覽</h3><ul>
<li>網頁瀏覽<br>使用者一進入網頁，就會觸發 網頁瀏覽。</li>
<li>DOM 就緒<br>當使用者進入網頁後，會開始讀取DOM (html)內容，從上往下跑一次，跑到底就會觸發 DOM 就緒。</li>
<li>視窗已載入<br>當讀取完成DOM之後，會繼續執行載入檔案內容，例如圖片、影片、js css檔案、iframe等等，當這些都載入完成，就會觸發 視窗已載入。</li>
</ul>
<h3 id="點擊"><a href="#點擊" class="headerlink" title="點擊"></a>點擊</h3><ul>
<li>僅連結<br>使用者點選連結 (<code>&lt;a href=&quot;domain/pathname&quot;&gt;Link Text&lt;/a&gt;</code>)，才會觸發。</li>
<li>所有元素<br>使用者隨意在頁面上做點擊動作，就會觸發。例如我點了網頁的空白區塊，就會觸發了。</li>
</ul>
<h3 id="使用者主動參與"><a href="#使用者主動參與" class="headerlink" title="使用者主動參與"></a>使用者主動參與</h3><ul>
<li>YouTube 影片<br>當網站上嵌入youtube影片，觀看影片的各種狀況，開始、暫停、完成播放，觀看影片的百分比設定。</li>
<li>元素可見度<br>網頁上物件出現在畫面上，都可以算是觸發元素可見度。包括載入出現、滾動出現、變化樣式css等等。</li>
<li>捲動頁數<br>針對滾動整個網頁觸發，用來計算滾動的百分比，可以讓自己定義要追蹤的比率。</li>
<li>表單提交<br>使用者提交表單就會觸發，<code>&lt;form&gt;&lt;button&gt;送出&lt;/button&gt;&lt;/form&gt;</code>form html架構才會觸發，如果是使用javascript ajax傳輸，就不會觸發到表單提交。</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>JavaScript 錯誤<br>使用window.onError來監聽錯誤，會提供錯誤訊息、錯誤網址、錯誤行號碼等資訊。</li>
<li>自訂事件<br>dataLayer.push({event:{eventName}})，會依照 dataLayer中 event 觸發。</li>
<li>計時器<br>可以設定某個動作觸發開始計時，之後再依照設定的時間倒數後在觸發另一個事件。</li>
<li>記錄變更<br>當使用history.pushState()時會被觸發，可以處理spa的網址變化，運用在react-router。</li>
</ul>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/triggerlist.png" alt="tag manager triggerlist" title="tag manager triggerlist"><noscript><img src="/images/triggerlist.png" alt="tag manager triggerlist" /></noscript></p>
<h2 id="II-變數"><a href="#II-變數" class="headerlink" title="II.變數"></a>II.變數</h2><p>變數可能會比較抽象，簡單介紹一下什麼叫做變數，變數可以當作<code>賦予某個值一個名稱</code>，至於為什麼要命名變數，因為方便我們之後可以直接拿這個變數名稱來使用。</p>
<p>打開變數區塊=&gt;點擊新增，會看到tag manager會預設好幾個比較常用到的變數，click text、url、pathName等等，下方還可以讓你新增使用者自己的變數，有很多種可以新增，比較常用的會是 dataLayer帶變數、還有javascript function return。</p>
<ul>
<li>javascript function return - 回傳留言欄位的內容<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">document</span>.getElementById(<span class="string">'commentValue'</span>).value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<img src="/images/loading-image.png"class="lazyload" data-src="/images/tagtitle.png" alt="tag manager tagtitle" title="tag manager tagtitle"><noscript><img src="/images/tagtitle.png" alt="tag manager tagtitle" /></noscript><br>上面的名稱我取作 comment_value，也就是說之後只要其他地方輸入  就可以取得留言的內容。</li>
</ul>
<p>這邊如果不會寫javascript的話，也可以使用內建好的變數，記得要勾選後才能被取用。</p>
<h2 id="III-代碼"><a href="#III-代碼" class="headerlink" title="III.代碼"></a>III.代碼</h2><p>這部分就是tag manager的核心，經由設定觸發條件，然後執行代碼。tag manager整合非常多的不同工具，除了facebook pixel…。</p>
<p><a href="https://support.google.com/tagmanager/answer/6106924" target="_blank" rel="noopener" title="tag manager 支援代碼">tag manager 支援代碼</a></p>
<p>我們以ga設定事件為例子，原本你在ga設定事件，會需要在網站上寫<code>ga(&#39;send&#39;, &#39;event&#39;, 類別, 動作, 標籤 )</code>，在這邊都視覺化了，每個類別、動作、標籤都分欄位讓你輸入，所以不用會寫javascript，你也可以輕易設定事件，更重要是不需要透過工程師幫你處理。</p>
<p>簡單講就是，你在tag manager的追蹤設定，不會影響到原本網站上的程式架構。網站上一定會埋一堆哩哩摳摳的程式碼，對工程師來說每建立一個新頁面都要用整包，畫面不乾淨也不好維運。它可以幫助你追蹤碼分離掉。</p>
<p>點擊代碼新增 =&gt; 選擇google analytics，使用ga的事件。</p>
<p>再來建立類別、動作、標籤，標籤這邊用我們建立的變數<code>comment_value</code>，最後觸發條件再選擇送出留言。</p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagsmaple5.png" alt="tag manager tagsmaple5" title="tag manager tagsmaple5"><noscript><img src="/images/tagsmaple5.png" alt="tag manager tagsmaple5" /></noscript></p>
<h2 id="追蹤-adblock-實作範例"><a href="#追蹤-adblock-實作範例" class="headerlink" title="追蹤 adblock 實作範例"></a>追蹤 adblock 實作範例</h2><p>上面講了一遍後，再來試著操作一遍，需求是，要追蹤來我的blog的人，有多少人使用adblock，使用ga事件來記錄。</p>
<p>以需求來看，觸發點就會是載入頁面後，判斷廣告區塊沒有正常顯示，所以我們要建立一個觸發，執行ga事件的代碼。</p>
<p>這邊來用tag manager 代碼區塊的自訂html。建立一個javascript，這段是要判斷google-auto-placed有沒有在html上，這是google自動廣告會帶的className，如果沒有這個class，就代表使用者有裝設adblock。然後使用<code>dataLayer.push({event: &#39;getAdblock&#39;})</code>產生自訂事件。</p>
<ul>
<li>代碼區塊使用自訂html<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (<span class="built_in">document</span>.getElementsByClassName(<span class="string">'google-auto-placed'</span>).length === <span class="number">0</span>) &#123;</span></span><br><span class="line">    dataLayer.push(&#123;</span><br><span class="line"><span class="actionscript">      event: <span class="string">'getAdblock'</span></span></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<img src="/images/loading-image.png"class="lazyload" data-src="/images/tagsample.png" alt="tag manager tagsample" title="tag manager tagsample"><noscript><img src="/images/tagsample.png" alt="tag manager tagsample" /></noscript></li>
</ul>
<p>接下來，到觸發區塊點選點選 自訂事件，在輸入剛剛push event的名稱 getAdblock。</p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagsample3.png" alt="tag manager tagsample3" title="tag manager tagsample3"><noscript><img src="/images/tagsample3.png" alt="tag manager tagsample3" /></noscript></p>
<p>進入代碼區塊，建立一個ga事件，再輸入事件類別、動作、標籤，觸發就選擇剛剛建好的觸發條件。</p>
<p><img src="/images/loading-image.png"class="lazyload" data-src="/images/tagsample2.png" alt="tag manager tagsample2" title="tag manager tagsample2"><noscript><img src="/images/tagsample2.png" alt="tag manager tagsample2" /></noscript></p>
<p>這樣就大功告成了!!</p>
<p>ps.記得點開tag manager預覽模式，來看一下代碼有沒有成功跑起來。</p>
<h2 id="工作實作心得"><a href="#工作實作心得" class="headerlink" title="工作實作心得"></a>工作實作心得</h2><p>記得我兩年前第一次接觸 tag manager，評語是 <em>這鬼東西太複雜難用了吧</em> 。但不知道是不是兩年間有改版，最近回頭接觸的感想，發現其實滿好用的！特別是預覽模式，很清楚的在發布前測試有沒有設定正確。</p>
<p>會一直介紹 tag manager的原因，絕對不是因為我最近每天工作都要接觸 tag manager(眼神死…)，是 tag manager功能真的太強大了，對前端開發來說也減少非常多的工時，省去在專案上處理各種 ga(xxx)的麻煩、突兀，轉而關注處理 dataLayer。</p>
<p>最後最後，如果你是行銷人，然後會用tag manager的話，我非常敬佩你。</p>
<p>感謝閱讀！</p>
<script>document.addEventListener("DOMContentLoaded", function() {
  var lazyImages = [].slice.call(document.querySelectorAll(".lazyload"));
  if ("IntersectionObserver" in window) {
    let lazyImageObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          let lazyImage = entry.target;
          lazyImage.src = lazyImage.dataset.src;
          lazyImage.onload = function(){
            lazyImage.classList.remove("lazyload");
          }
          lazyImageObserver.unobserve(lazyImage);
        }
      });
    }, {
        rootMargin: '100px'
    });

    lazyImages.forEach(function(lazyImage) {
      lazyImageObserver.observe(lazyImage);
    });
  } else {
    lazyImages.forEach(function(lazyImage) {
      lazyImage.src = lazyImage.dataset.src;
      lazyImage.classList.remove("lazyload");
    });
  }
});</script></div><script type="text/javascript" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8378986291968146" data-ad-slot="5563177745" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="tags"><a href="/tags/google-analytics/">google_analytics</a><a href="/tags/tag-manager/">tag_manager</a></div><div class="post__related"><span class="category-title"> Related : </span><span class="category"><category class="name"></category><category class="name"></category></span><ul class="related-posts"><li class="related-posts-item"><a class="related-posts-link" href="/2018/08/26/tagmanager/">Google Tag Manager tracking code 安裝追蹤碼</a></li><li class="related-posts-item"><a class="related-posts-link" href="/2018/04/25/gaevents/">Google analytics 事件追蹤、轉換目標設定教學 ga event</a></li><li class="related-posts-item"><a class="related-posts-link" href="/2019/06/15/gauserid/">Google Analytics 自訂UserId 追蹤數據</a></li><li class="related-posts-item"><a class="related-posts-link" href="/2018/06/23/gautm/">Google analytics UTM設定參數，追蹤facebook廣告、簡訊、EDM</a></li><li class="related-posts-item"><a class="related-posts-link" href="/2018/07/30/gasession/">Google Analytics 工作階段介紹、定義</a></li></ul></div><div class="post-nav"><a class="pre" href="/2018/10/27/imgprogress/">Upload progress bar drag&amp;drop 圖片拖拉上傳進度條</a><a class="next" href="/2018/10/11/nodejsapi/">Node.js Express MongoDB RESTful Api 留言板實作教學</a></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论 「请确保 disqus.com 可以正常加载」</button></div><script>var disqus_shortname = 'ianchuu';
var disqus_identifier = '2018/10/16/tagteach/';
var disqus_title = 'Google Tag Manager(gtm)教學 觸發、代碼、變數設定介紹';
var disqus_url = 'https://iandays.com/2018/10/16/tagteach/';
$('.btn_click_load').click(function() {
  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
  $('.btn_click_load').css('display','none');
});
document.addEventListener("DOMContentLoaded", function() {
  var disqusElement = document.getElementById("disqus_thread");
  if ("IntersectionObserver" in window) {
    let lazyLoadObserver = new IntersectionObserver(function(entries, observer) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          loadDisqus();
          lazyLoadObserver.unobserve(disqusElement);
        }
      });
    }, {
        rootMargin: '300px'
    });
    lazyLoadObserver.observe(disqusElement);
  } else {
    loadDisqus();
  }
});
function loadDisqus(){
  $.ajax({
    url: 'https://disqus.com/next/config.json',
    timeout: 3000,
    type: 'GET',
    success: (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      $('.btn_click_load').css('display','none');
    })(),
    error: function() {
      $('.btn_click_load').css('display','block');
    }
  });
}
</script><script id="dsq-count-scr" src="//ianchuu.disqus.com/count.js" async></script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="https://iandays.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 贊助創作</i></div><a target="_blank" href="https://store.line.me/stickershop/author/1019955/zh-Hant" targer="_blank" alt="小河馬與牠的快樂夥伴"><div style="    width: 100%;    text-align: center;    padding: 10px;    "><img class="nofancybox" src="/images/hippo.png" alt="貼圖"/><div>Line 貼圖</div></div></a></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分類</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/life/">life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/marketing/">marketing</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 標籤</i></div><div class="tagcloud"><a href="/tags/array/" style="font-size: 15px;">array</a> <a href="/tags/google-map/" style="font-size: 15px;">google_map</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/seo/" style="font-size: 15px;">seo</a> <a href="/tags/google-form/" style="font-size: 15px;">google_form</a> <a href="/tags/frontend/" style="font-size: 15px;">frontend</a> <a href="/tags/google-analytics/" style="font-size: 15px;">google_analytics</a> <a href="/tags/facebook/" style="font-size: 15px;">facebook</a> <a href="/tags/react-js/" style="font-size: 15px;">react.js</a> <a href="/tags/node-js/" style="font-size: 15px;">node.js</a> <a href="/tags/prototype/" style="font-size: 15px;">prototype</a> <a href="/tags/tag-manager/" style="font-size: 15px;">tag_manager</a> <a href="/tags/testing/" style="font-size: 15px;">testing</a></div></div><script type="text/javascript" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async="async"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8378986291968146" data-ad-slot="3619826098" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/06/27/closure/">JavaScript Closure 你一定有用過的閉包</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/29/immutable/">Immutable 對於 React 重要性</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/28/reactpuppeteer/">Puppeteer End-to-End Test React</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/11/iframeblockcookie/">阻擋第三方(Block third-party) Cookie，各瀏覽器狀態</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/30/reduxdispatch/">Redux multiple dispatch，batch redux-thunk</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/09/29/jestunit/">React Unit Test with Jest 單元測試</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/04/gacrossdomain/">GA跨網域追蹤 google analytics cross-domain tracking</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/28/reactcontextapi/">React Context API 跨元件傳遞資料</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/15/gauserid/">Google Analytics 自訂UserId 追蹤數據</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/08/firstjob/">第一份工作</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 家裡招牌</i></div><ul></ul><a href="https://www.hoyasign.com/" title="弘揚廣告招牌" target="_blank">弘揚廣告招牌</a></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近評論</i></div><script type="text/javascript" src="//ianchuu.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Ian Chu. 時間飛逝如砲彈</a> | by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"></a> <a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script>function loadCSS(e, t, n) { "use strict"; var i = window.document.createElement("link"); var o = t || window.document.getElementsByTagName("script")[0]; i.rel = "stylesheet"; i.href = e; i.media = "only x"; o.parentNode.insertBefore(i, o); setTimeout(function () { i.media = n || "all" }) }loadCSS("https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css");
</script><script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script><script type="text/javascript" src="/js/all.js?1594052923282" async></script></div></body><div class="btn-menu"><span class="bar"></span><span class="text">Menu </span></div><div class="overlay"><ul><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input class="search-input pure-u-2-5" type="text" name="q" maxlength="20" placeholder="輸入關鍵字"><input type="hidden" name="sitesearch" value="https://iandays.com"><button class="search-button pure-button pure-u-1-3">Search</button></form></ul><ul><a class="current" href="/."><i class="fa fa-home"> 首頁</i></a><a href="/archives/"><i class="fa fa-archive"> 所有文章</i></a><a href="/about/"><i class="fa fa-user"> 關於</i></a><a href="/atom.xml"><i class="fa fa-rss"> 訂閱</i></a></ul><ul class="list-title"><i class="fa fa-folder-o"> 分類</i></ul><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/javascript/">javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/life/">life</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/marketing/">marketing</a></li></ul><ul class="list-title"><i class="fa fa-file-o"> 最近文章</i></ul><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/06/27/closure/">JavaScript Closure 你一定有用過的閉包</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/29/immutable/">Immutable 對於 React 重要性</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/28/reactpuppeteer/">Puppeteer End-to-End Test React</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/11/iframeblockcookie/">阻擋第三方(Block third-party) Cookie，各瀏覽器狀態</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/30/reduxdispatch/">Redux multiple dispatch，batch redux-thunk</a></li></ul></div></html>